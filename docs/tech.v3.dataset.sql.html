<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tech.v3.dataset.sql documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">tech.ml.dataset.sql</span> <span class="project-version">5.00-alpha1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="tech.v3.dataset.sql.html"><div class="inner"><span>tech.v3.dataset.sql</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-create-table.21"><div class="inner"><span>create-table!</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-drop-table.21"><div class="inner"><span>drop-table!</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-drop-table-when-exists.21"><div class="inner"><span>drop-table-when-exists!</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-ensure-table.21"><div class="inner"><span>ensure-table!</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-execute-prepared-statement-batches"><div class="inner"><span>execute-prepared-statement-batches</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-insert-dataset.21"><div class="inner"><span>insert-dataset!</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-result-set-.3Edataset"><div class="inner"><span>result-set-&gt;dataset</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-sanitize-dataset-names-for-sql"><div class="inner"><span>sanitize-dataset-names-for-sql</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-sql-.3Edataset"><div class="inner"><span>sql-&gt;dataset</span></div></a></li><li class="depth-1"><a href="tech.v3.dataset.sql.html#var-table-exists.3F"><div class="inner"><span>table-exists?</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tech.v3.dataset.sql</h1><div class="doc"><div class="markdown"><p>Pathways to transform dataset to and from SQL databases. Built directly on java.sql interfaces.</p></div></div><div class="public anchor" id="var-create-table.21"><h3>create-table!</h3><div class="usage"><code>(create-table! conn dataset options)</code><code>(create-table! conn dataset)</code></div><div class="doc"><div class="markdown"><p>Create a table. Exception upon failure to drop the table.</p>
<ul>
  <li>conn - java.sql.Connection</li>
  <li>dataset - dataset to use. The dataset-name will be used as the table-name and the  column names and datatypes will be used for the sql names and datatypes.</li>
</ul>
<p>The dataset’s dataset-name will be used for the table and if the dataset’s metadata has a :primary-key member this will be interpreted as a sequence of column names to be used as the primary key.</p>
<p>Options:</p>
<ul>
  <li><code>:table-name</code> - set the name of the table to use. Overrides the dataset metadata.</li>
  <li><code>:primary-key</code> - Array of column names to use as the primary key of this table.  Overrides the dataset metadata.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L115">view source</a></div></div><div class="public anchor" id="var-drop-table.21"><h3>drop-table!</h3><div class="usage"><code>(drop-table! conn dataset)</code></div><div class="doc"><div class="markdown"><p>Drop a table. Exception upon failure to drop the table.</p>
<ul>
  <li>conn - java.sql.Connection</li>
  <li>dataset - string, keyword, symbol, or dataset</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L98">view source</a></div></div><div class="public anchor" id="var-drop-table-when-exists.21"><h3>drop-table-when-exists!</h3><div class="usage"><code>(drop-table-when-exists! conn dataset)</code></div><div class="doc"><div class="markdown"><p>Drop the table indicated by this dataset if it exists.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L108">view source</a></div></div><div class="public anchor" id="var-ensure-table.21"><h3>ensure-table!</h3><div class="usage"><code>(ensure-table! conn dataset options)</code><code>(ensure-table! conn dataset)</code></div><div class="doc"><div class="markdown"><p>Create a table if it does not exist. See documentation for create-table!</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L147">view source</a></div></div><div class="public anchor" id="var-execute-prepared-statement-batches"><h3>execute-prepared-statement-batches</h3><div class="usage"><code>(execute-prepared-statement-batches conn stmt-or-sql dataset options)</code></div><div class="doc"><div class="markdown"><p>Internal method to, using a dataset, execute prepared statement batches drawn from the rows of the dataset. For this to work correctly, the connection needs to have autoCommit set to false.</p>
<ul>
  <li>conn - java.sql.Connection</li>
  <li>stmt-or-sql - Either a prepared statement or a string in which case  the connection’s .prepareStatement method will be called.</li>
  <li>dataset - dataset</li>
</ul>
<p>Options</p>
<ul>
  <li>batch-size - integer, defaults to 32</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L160">view source</a></div></div><div class="public anchor" id="var-insert-dataset.21"><h3>insert-dataset!</h3><div class="usage"><code>(insert-dataset! conn dataset options)</code><code>(insert-dataset! conn dataset)</code></div><div class="doc"><div class="markdown"><p>Insert a dataset into a table indicated by the dataset name.</p>
<p>Options:</p>
<ul>
  <li><code>:postgres-upsert?</code> - defaults to false. When true, generates postgres-specific sql  that performs an upsert operation.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L207">view source</a></div></div><div class="public anchor" id="var-result-set-.3Edataset"><h3>result-set-&gt;dataset</h3><div class="usage"><code>(result-set-&gt;dataset results {:keys [close?], :or {close? true}, :as options})</code><code>(result-set-&gt;dataset results)</code></div><div class="doc"><div class="markdown"><p>Given a result set, return a dataset.</p>
<p>Options:</p>
<ul>
  <li><code>:close?</code> - if true, then .close is called on the resultset - always - including when  there is an exception. Defaults to true.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L19">view source</a></div></div><div class="public anchor" id="var-sanitize-dataset-names-for-sql"><h3>sanitize-dataset-names-for-sql</h3><div class="usage"><code>(sanitize-dataset-names-for-sql ds)</code></div><div class="doc"><div class="markdown"><p>Given a dataset, sanitize the dataset name and the names of all the columns such that they are safe for insert to SQL.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L71">view source</a></div></div><div class="public anchor" id="var-sql-.3Edataset"><h3>sql-&gt;dataset</h3><div class="usage"><code>(sql-&gt;dataset conn sql options)</code><code>(sql-&gt;dataset conn sql)</code></div><div class="doc"><div class="markdown"><p>Given a connection and an sql statement, convert the results of executing the statement to a dataset. For options, see <code>result-set-&gt;dataset</code></p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L56">view source</a></div></div><div class="public anchor" id="var-table-exists.3F"><h3>table-exists?</h3><div class="usage"><code>(table-exists? conn dataset)</code></div><div class="doc"><div class="markdown"><p>Test if a table exists.</p>
<ul>
  <li>conn - java.sql.Connection</li>
  <li>dataset - string, keyword, symbol, or dataset</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset.sql/blob/master/src/tech/v3/dataset/sql.clj#L84">view source</a></div></div></div></body></html>